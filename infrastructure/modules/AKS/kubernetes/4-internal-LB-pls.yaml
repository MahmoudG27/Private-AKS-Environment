apiVersion: v1
kind: Service
metadata:
  name: nginx-ingress-internal
  annotations:
    # make ILB
    service.beta.kubernetes.io/azure-load-balancer-internal: "true"
    # optional: put ILB in a specific subnet by name
    service.beta.kubernetes.io/azure-load-balancer-internal-subnet: "snet-aks"
    # create PLS from this ILB (AKS cloud provider will create a Private Link Service)
    service.beta.kubernetes.io/azure-pls-create: "true"
    # which subscriptions can see / request this PLS (use "*" for all)
    service.beta.kubernetes.io/azure-pls-visibility: "*"
    # auto-approve private endpoint requests from specified subscription(s)
    # (replace <YOUR_SUBSCRIPTION_ID> with the subscription that will host Front Door or "*" usage)
    service.beta.kubernetes.io/azure-pls-auto-approval: "<YOUR_FRONTDOOR_SUBSCRIPTION_ID>"
    # optional: set NAT / PLS IP(s) that PLS will allocate
    service.beta.kubernetes.io/azure-pls-ip-configuration-ip-address: "10.0.2.5"
    service.beta.kubernetes.io/azure-pls-ip-configuration-ip-address-count: "1"
    # optionally enable PROXY protocol if backend supports it
    service.beta.kubernetes.io/azure-pls-proxy-protocol: "false"
spec:
  type: LoadBalancer
  loadBalancerIP: 10.0.1.10   # the specific ILB IP you want (must be free in subnet)
  ports:
    - port: 80
      targetPort: 80
  selector:
    app.kubernetes.io/name: ingress-nginx
